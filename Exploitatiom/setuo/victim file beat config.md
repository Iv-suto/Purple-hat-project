# üì¶ Filebeat Configuration on Victim Machine

## üéØ Objective

Set up Filebeat on the victim machine to monitor and forward system logs (such as SSH login attempts and shell activity) to a local Elasticsearch instance. This allows attacks to be logged and analyzed in near real-time.

---

## üñ•Ô∏è Environment

- **Victim OS:** Ubuntu Server
- **Elasticsearch Location:** Same machine or attacker machine (via IP)
- **Filebeat Version:** Installed from official repository

---

## üîß Step-by-Step Setup

### 1. Install Filebeat

```bash
sudo apt update
sudo apt install filebeat
```

---

### 2. Configure Inputs

Edit the config file:

```bash
sudo nano /etc/filebeat/filebeat.yml
```

Set the inputs to monitor important log files:

```yaml
filebeat.inputs:
  - type: log
    enabled: true
    paths:
      - /var/log/auth.log
      - /var/log/syslog
```

---

### 3. Configure Output to Elasticsearch

In the same config file, update the output section:

```yaml
output.elasticsearch:
  hosts: ["http://<elasticsearch-ip>:9200"]
```

Replace `<elasticsearch-ip>` with:
- `localhost` if Elasticsearch is running on the same machine
- The IP of the machine running Elasticsearch otherwise

---

### 4. Test the Configuration

```bash
sudo filebeat test config
```

Expected output: `Config OK`

---

### 5. Start and Enable the Service

```bash
sudo systemctl enable filebeat
sudo systemctl start filebeat
```

---

### ‚úÖ Result

Filebeat successfully began shipping logs from:
- `/var/log/auth.log` ‚Äî includes login attempts and SSH failures
- `/var/log/syslog` ‚Äî includes system-level events

These logs were later verified in Elasticsearch using:

```bash
curl -X GET "http://localhost:9200/_cat/indices?v"
```

and

```bash
curl -X GET "http://localhost:9200/filebeat-*/_search?q=sshd&pretty"
```

---

## üß† Lessons Learned

- Log shipping must be tested before the attack for reliability
- Port conflicts and SSL settings in Elasticsearch can cause Filebeat errors ‚Äî using HTTP mode simplifies setup
- Real-time logging enables early detection of intrusion activity
